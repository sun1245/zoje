define(["jquery","tools","bootstrap","jquery.Jcrop"],function(t){var o={};return o.showCoords=function(t){o.w=t.w,o.h=t.h,o.x1=t.x,o.x2=t.x2,o.y1=t.y,o.y2=t.y2},o.clearCoords=function(){},o.init=function(){void 0!==o.jcrop_api&&o.jcrop_api.destroy(),t("#crop-target").Jcrop({onChange:o.showCoords,onSelect:o.showCoords,onRelease:o.clearCoords},function(){o.jcrop_api=this})},t(".js-img-list-f").delegate(".js-goal a[data-crop]","click",function(a){a.preventDefault();var r=t(this).data("crop");t("#crop-btn").attr("data-fid",r),t.getJSON(UPLOADDO_URL+"get_ajax/"+r).done(function(a){img_url=UPLOAD_URL+a.url;var r=img_url+"?n="+100*Math.random();t("#crop-target").attr("src",r),t("#crop-modal").modal(),o.init()})}),t("#crop-btn").on("click",function(){if(t.isNumeric(o.w)){var a={};a.x=o.x1,a.y=o.y1,a.w=o.w,a.h=o.h,a.fid=t(this).attr("data-fid")-0,t.ajax({url:UPLOADDO_URL+"gd_ajax",type:"GET",dataType:"json",data:a}).done(function(a){console.log("success"),1==a.status?(t.pnotify({title:"裁剪",text:a.msg,type:"success",animation:"fade"}),tmp_url=img_url+"?n="+100*Math.random(),t("#crop-target").attr("src",tmp_url),o.init(),t("#crop-modal").modal("hide")):bootbox.alert("<span class='text-error'>"+a.msg+"</span>")}).fail(function(o){var a=o.responseJSON;t.pnotify({title:"错误提示！",text:a.msg,type:"error",animation:"fade"}),t("#"+domf).after(ui.alert("访问数据列表错误 ：<br />"+a))}).always(function(){console.log("complete")})}else bootbox.alert("你还没有任何的裁剪。")}),function(){}});