function clsIDCard(a){this.Valid=false;this.ID15="";this.ID18="";this.Local="";if(a!=null){this.SetCardNo(a)}}clsIDCard.prototype.SetCardNo=function(a){this.ID15="";this.ID18="";this.Local="";a=a.replace(" ","");var b;if(a.length==18){pattern=/^\d{17}(\d|x|X)$/;if(pattern.exec(a)==null){return}b=a.toUpperCase()}else{pattern=/^\d{15}$/;if(pattern.exec(a)==null){return}b=a.substr(0,6)+"19"+a.substr(6,9);b+=this.GetVCode(b)}this.Valid=this.CheckValid(b)};clsIDCard.prototype.IsValid=function(){return this.Valid};clsIDCard.prototype.GetBirthDate=function(){var a="";if(this.Valid){a=this.GetBirthYear()+"-"+this.GetBirthMonth()+"-"+this.GetBirthDay()}return a};clsIDCard.prototype.GetBirthYear=function(){var a="";if(this.Valid){a=this.ID18.substr(6,4)}return a};clsIDCard.prototype.GetBirthMonth=function(){var a="";if(this.Valid){a=this.ID18.substr(10,2)}if(a.charAt(0)=="0"){a=a.charAt(1)}return a};clsIDCard.prototype.GetBirthDay=function(){var a="";if(this.Valid){a=this.ID18.substr(12,2)}return a};clsIDCard.prototype.GetSex=function(){var a="";if(this.Valid){a=this.ID18.charAt(16)%2}return a};clsIDCard.prototype.Get15=function(){var a="";if(this.Valid){a=this.ID15}return a};clsIDCard.prototype.Get18=function(){var a="";if(this.Valid){a=this.ID18}return a};clsIDCard.prototype.GetLocal=function(){var a="";if(this.Valid){a=this.Local}return a};clsIDCard.prototype.GetVCode=function(e){var d=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1);var c=new Array("1","0","X","9","8","7","6","5","4","3","2");var b=0;for(var f=0;f<e.length;f++){b+=e.charAt(f)*d[f]}var a=b%11;return c[a]};clsIDCard.prototype.CheckValid=function(a){if(this.GetVCode(a.substr(0,17))!=a.charAt(17)){return false}if(!this.IsDate(a.substr(6,8))){return false}var b={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(b[parseInt(a.substr(0,2))]==null){return false}this.ID18=a;this.ID15=a.substr(0,6)+a.substr(8,9);this.Local=b[parseInt(a.substr(0,2))];return true};clsIDCard.prototype.IsDate=function(a){var b=a.match(/^(\d{1,4})(\d{1,2})(\d{1,2})$/);if(b==null){return false}var c=new Date(b[1],b[2]-1,b[3]);return(c.getFullYear()==b[1]&&(c.getMonth()+1)==b[2]&&c.getDate()==b[3])};